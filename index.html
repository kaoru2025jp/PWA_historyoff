<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>計算結果送信</title>
<style>
  body {
    font-family: sans-serif;
    padding: 20px;
  }
  input {
    font-size: 16px;
    padding: 5px;
    width: 200px;
    display: block;
    margin-bottom: 8px;
  }
  button {
    font-size: 16px;
    padding: 8px 16px;
    margin-top: 10px;
  }
</style>
</head>
<body>

<h2>計算（B - O × T）</h2>

<input id="b" placeholder="B">
<input id="o" placeholder="O">
<input id="t" placeholder="T">

<button onclick="calcAndSend()">計算して送信</button>

<script>
function calcAndSend() {
  const B = Number(document.getElementById("b").value);
  const O = Number(document.getElementById("o").value);
  const T = Number(document.getElementById("t").value);

  if (isNaN(B) || isNaN(O) || isNaN(T)) {
    alert("すべて数値で入力してください");
    return;
  }

  // ① 計算
  const S = B - O * T;

  // ② 成功実績のある送信方式をそのまま使用
  const GAS_URL =
    "https://script.google.com/macros/s/AKfycbxY8D8lRBCGACJwM9vgBPZvcPt_IqF2POa0oNp0C-p67ZSrnBwKccdeVQgdGkSW-6K0/exec";

  const script = document.createElement("script");
  script.src =
    GAS_URL +
    "?numbers=" + encodeURIComponent(S) +
    "&callback=handleResponse";

  document.body.appendChild(script);
}

function handleResponse(res) {
  if (res.status === "ok") {
    alert("計算結果を記録しました");
  }
}
</script>

</body>
</html>
